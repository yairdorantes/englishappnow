{"ast":null,"code":"import _objectSpread from\"/home/yair/Desktop/english/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/home/yair/Desktop/english/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/yair/Desktop/english/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/yair/Desktop/english/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./styles/postCards.css\";import{useContext,useEffect,useState}from\"react\";import Loader from\"./Loader\";import{helpHttp}from\"../helpers/helpHttp\";import AuthContext from\"../context/AuthContext\";import{Link}from\"react-router-dom\";import MenuBar from\"./MenuBar\";// import remarkGfm from \"remark-gfm\";\nimport{isMobile}from\"react-device-detect\";import mySite from\"./Domain\";import Heart from\"./Heart\";import axios from\"axios\";import NewMenu from\"./NewMenu\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var url=\"\".concat(mySite,\"postset/\");var like=\"\".concat(mySite,\"posts/\");var Posts=function Posts(){var _useContext=useContext(AuthContext),user=_useContext.user;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),likes=_useState2[0],setLikes=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var fetchAPi=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:axios.get(url).then(function(res){setPosts(res.data);}).catch(function(err){console.log(err,\"here\");});case 1:case\"end\":return _context.stop();}}},_callee);}));return function fetchAPi(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchAPi();},[]);var giveLike=function giveLike(post){var updatedPost=_objectSpread({},post);updatedPost.likes_count+=1;setPosts(function(prevPosts){return prevPosts.map(function(p){return p.id===updatedPost.id?updatedPost:p;});});var options={body:{is_like:true,id:post.id,user_id:user.user_id},headers:{\"content-type\":\"application/json\"}};helpHttp().post(like,options);};var giveDislike=function giveDislike(post){var updatedPost=_objectSpread({},post);updatedPost.likes_count-=1;setPosts(function(prevPosts){return prevPosts.map(function(p){return p.id===updatedPost.id?updatedPost:p;});});var options={body:{is_like:false,id:post.id,user_id:user.user_id},headers:{\"content-type\":\"application/json\"}};helpHttp().post(like,options);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NewMenu,{}),/*#__PURE__*/_jsx(\"div\",{className:\"main-container-post\",style:{height:isMobile?\"100%\":\"100vh\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"container-posts\",children:!posts?/*#__PURE__*/_jsx(Loader,{}):posts.map(function(post){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-post \",children:[/*#__PURE__*/_jsxs(Link,{to:\"/postpage/\".concat(post.id),className:\"link-post\",children:[/*#__PURE__*/_jsx(\"div\",{style:{backgroundImage:\"url(\"+post.image_src+\")\"},className:\"box-img-post-card\"}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:\"\".concat(post.categoria.color)},className:\"section-post\",children:/*#__PURE__*/_jsx(\"span\",{children:post.categoria.name})}),/*#__PURE__*/_jsx(\"div\",{className:\"container-card-text\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"title-post-card\",children:post.title})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(Heart,{txt:post.likes_count,state:post.likes.indexOf(user.user_id)!==-1?true:false,actions:{like:function like(){return giveLike(post);},dislike:function dislike(){return giveDislike(post);}}})})]},post.id)});})})})]});};export default Posts;","map":{"version":3,"names":["useContext","useEffect","useState","Loader","helpHttp","AuthContext","Link","MenuBar","isMobile","mySite","Heart","axios","NewMenu","url","like","Posts","user","likes","setLikes","posts","setPosts","fetchAPi","get","then","res","data","catch","err","console","log","giveLike","post","updatedPost","likes_count","prevPosts","map","p","id","options","body","is_like","user_id","headers","giveDislike","height","backgroundImage","image_src","backgroundColor","categoria","color","name","title","indexOf","dislike"],"sources":["/home/yair/Desktop/english/src/components/Posts.js"],"sourcesContent":["import \"./styles/postCards.css\";\nimport { useContext, useEffect, useState } from \"react\";\nimport Loader from \"./Loader\";\nimport { helpHttp } from \"../helpers/helpHttp\";\nimport AuthContext from \"../context/AuthContext\";\nimport { Link } from \"react-router-dom\";\nimport MenuBar from \"./MenuBar\";\n\n// import remarkGfm from \"remark-gfm\";\nimport { isMobile } from \"react-device-detect\";\nimport mySite from \"./Domain\";\nimport Heart from \"./Heart\";\nimport axios from \"axios\";\nimport NewMenu from \"./NewMenu\";\n\nlet url = `${mySite}postset/`;\nlet like = `${mySite}posts/`;\n\nconst Posts = () => {\n  let { user } = useContext(AuthContext);\n  const [likes, setLikes] = useState([]);\n\n  const [posts, setPosts] = useState();\n\n  const fetchAPi = async () => {\n    axios\n      .get(url)\n      .then((res) => {\n        setPosts(res.data);\n      })\n      .catch((err) => {\n        console.log(err, \"here\");\n      });\n  };\n\n  useEffect(() => {\n    fetchAPi();\n  }, []);\n\n  const giveLike = (post) => {\n    let updatedPost = { ...post };\n    updatedPost.likes_count += 1;\n    setPosts((prevPosts) =>\n      prevPosts.map((p) => (p.id === updatedPost.id ? updatedPost : p))\n    );\n    let options = {\n      body: { is_like: true, id: post.id, user_id: user.user_id },\n      headers: { \"content-type\": \"application/json\" },\n    };\n    helpHttp().post(like, options);\n  };\n  const giveDislike = (post) => {\n    let updatedPost = { ...post };\n    updatedPost.likes_count -= 1;\n    setPosts((prevPosts) =>\n      prevPosts.map((p) => (p.id === updatedPost.id ? updatedPost : p))\n    );\n    let options = {\n      body: { is_like: false, id: post.id, user_id: user.user_id },\n      headers: { \"content-type\": \"application/json\" },\n    };\n    helpHttp().post(like, options);\n  };\n\n  return (\n    <>\n      <NewMenu />\n      <div\n        className=\"main-container-post\"\n        style={{ height: isMobile ? \"100%\" : \"100vh\" }}\n      >\n        <div className=\"container-posts\">\n          {!posts ? (\n            <Loader></Loader>\n          ) : (\n            posts.map((post) => {\n              return (\n                <div>\n                  <div key={post.id} className=\"card-post \">\n                    <Link to={`/postpage/${post.id}`} className=\"link-post\">\n                      <div\n                        style={{\n                          backgroundImage: \"url(\" + post.image_src + \")\",\n                        }}\n                        className=\"box-img-post-card\"\n                      ></div>\n                      <div\n                        style={{ backgroundColor: `${post.categoria.color}` }}\n                        className=\"section-post\"\n                      >\n                        <span>{post.categoria.name}</span>\n                      </div>\n                      <div className=\"container-card-text\">\n                        <h3 className=\"title-post-card\">{post.title}</h3>\n                      </div>\n                    </Link>\n                    <div className=\"\">\n                      <Heart\n                        txt={post.likes_count}\n                        state={\n                          post.likes.indexOf(user.user_id) !== -1 ? true : false\n                        }\n                        actions={{\n                          like: () => giveLike(post),\n                          dislike: () => giveDislike(post),\n                        }}\n                      />\n                    </div>\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Posts;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}